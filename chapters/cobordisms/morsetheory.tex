\label{sec:morsetheory}

Our primary use of Morse theory is to define a pair of related constructions.
The first is the \emph{handle decomposition} of a manifold, which comes with a dual decomposition.
The second is the \emph{Stein complex} of a Morse function on a manifold.
The main results from this chapter connect a Stein complex with a handle decomposition, and this construction is extended to triangulations in the remaining chapters.

\begin{defn}
	A generic smooth function $f:M\to\R$ with $M$ an $n$--manifold is called a \emph{Morse function}.
	For a critical point $p\in M$ of $f$, the \emph{index} of $p$ is the dimension of the largest subspace of $T_p M$ such that $d^2f_p$ is negative definite.
	Less formally, this corresponds to the number of independent directions in $M$ along which $f$ decreases.
	We denote by $M^a$ the subspace $f\inv(-\infty,a\,]$ where $f$ is a fixed Morse function on $M$.
\end{defn}

A key question of Morse theory regards how the topology of $M^a$ changes as $a$ passes the critical values of $f$.
This question is answered by the following two theorems.

\begin{theorem}
	\label{thm:morseretract}
	Let $f:M\to\R$ be a Morse function with no critical values in $(a,b\,]$, $a<b$.
	If $f\inv[\,a,b\,]$ is compact, then $M^a$ and $M^b$ are diffeomorphic, and $M^b$ deformation retracts onto $M^a$.
\end{theorem}

\begin{theorem}
	\label{thm:morsehandle}
	Let $f:M\to\R$ be a Morse function.
	Let $p$ be a critical point of $f$ of index $\lambda$ with associated critical value $f(p)=q$.
	If $f\inv[\,q-\varepsilon, q+\varepsilon\,]$ is compact and contains no critical points other than $p$, then $M^{q+\varepsilon}$ is diffeomorphic to $M^{q-\varepsilon}\cup_\varphi H^\lambda$ for some attaching map $\varphi:S^{\lambda-1}\times\D^\mu\to \pd(M^{q-\varepsilon})$.
\end{theorem}

\begin{defn}
	Let $f:M\to\R$ be a Morse function on a closed $n$--manifold $M$ with critical points $\{p_1,\dots,p_k\}$ of indices $\{\lambda_1,\dots,\lambda_k\}$ and a set $\{t_0,\dots,t_k\}$ of numbers in $\R$ such that
	\[
		0\leq t_0 < f(p_1) < t_1 < f(p_2) < \cdots < t_{k-1} < f(p_k) < t_k \leq 1,
	\]
	and
	\[
		\lambda_1 \leq \lambda_2 \leq \cdots \leq \lambda_k.
	\]
	The previous theorems guarantee that, for each $i\geq 1$, $f\inv[\,t_{i-1},t_i\,]$ is diffeomorphic to $(f\inv(t_{i-1})\times\I)\cup H^{\lambda_i}$, giving us a realization of $M$ as
	\[
		\emptyset = M_0 \subset M_1 \subset M_2 \subset \cdots \subset M_{k-1} \subset M_k = M
	\]
	where $M_i$ is obtained from $M_{i-1}$ by attaching a $\lambda_i$--handle.
	Such a realization is called a \emph{handle decomposition} of $M$.
\end{defn}

A Morse function $f$ satisfying the requirements to define a handle decomposition actually defines two handle decompositions --- one from $f$ and one from $1-f$.
The handle decompositions from $f$ and $1-f$ are dual in the sense that every $\lambda$--handle attached in the making of the decomposition from $f$ has a corresponding $\mu$--handle in the decomposition from $1-f$.
This handle is obtained by reversing the roles of the core and co--core in a given $\lambda$--handle $H^\lambda$ to obtain a $\mu$--handle $H^\mu$.

Similar definitions can be made for manifolds with boundary.
Let $W$ be an $n$--manifold with boundary $\pd W = M_0\sqcup M_1$, where both $M_0$ and $M_1$ are compact.
The Morse functions on $W$ that extend Theorems \ref{thm:morseretract} and \ref{thm:morsehandle} are those that fix $f(M_0)=0$, $f(M_1)=1$.
Now, the handle decomposition of $W$ is built on top of the component $M_1\times\{1\}$ of $M_0\times\I$, with $M_0\times\{0\}$ corresponding to the boundary component $M_0$ in the finished product.

Extending the range of a Morse function to $\RR$ yields another class of functions.
Members of this class exhibit some properties that are desirable for computational purposes.

\begin{defn}
	\label{def:morse2function}
	A generic smooth function $f:M\to\RR$ with $M$ an $n$--manifold is called a \emph{Morse 2--function}.
\end{defn}

In a similar fashion to basic Morse functions, assume that $M$ is closed and require that the image of $f$ is contained inside of $\DD\subset\RR$.

As stated before, we are using Morse theory to realize handle decompositions.
Our methods either use a Morse function $\Sigma\to[0,1]$ where $\Sigma$ is a 2--manifold or a Morse 2--function $M\to\DD$ where $M$ is a 3--manifold.
In these cases we introduce a factorization of our functions that yields the second construction alluded to at the beginning of this section.

\begin{defn}
	\label{def:stein}
	A function $f:X\to Y$ is \emph{proper} if, for any compact subset $C\subset Y$, the preimage $f\inv(C)$ is compact in $X$.
	A \emph{Stein factorization} of a proper function $f$ is a a decomposition of $f$ into $g\comp h$ with $$X\overset{h}{\to} S \overset{g}{\to} Y$$ such that $g$ is a finite--to--one map and $h$ has connected fibers.
	The intermediate space $S$ is called the \emph{Stein complex} of the factorization.
\end{defn}

The Stein complex of a proper function $f:X\to Y$ can be thought of as the quotient space of $X$ by a particular relation $\sim$.
For a pair of points $x_1$, $x_2$ in $X$ with $f(x_1)=f(x_2)=y$, we would define $x_1\sim x_2$ if $x_1$ and $x_2$ are in the same connected component of $f\inv(y)$.

Of primary interest are Morse functions $\Sigma\to[0,1]$ with $\Sigma$ a surface and Morse 2--functions $M\to\DD$ with $M$ a 3--manifold.
At this point we are delving into our main results, so we will begin assuming $\Sigma$ and $M$ are oriented.
To ensure a Stein factorization, a convenient assumption to make is that the manifold in question is compact.
We will go even further and make the stronger assumption that $\Sigma$ and $M$ are each closed.

When these assumptions are made and $f$ is a Morse function or Morse 2--function from an appropriate manifold, the regular value theorem guarantees that the preimage of a regular value of $f$ is the disjoint union of oriented circles.
This gives way to the general idea behind our algorithms.
The particulars of a Stein complex for a Morse function $\Sigma\to[0,1]$ or a Morse 2--function $M\to\DD$ are explored in the next two sections.
We then use the Stein complex as a set of instructions for constructing cobordisms for the pairs $(\Sigma,\emptyset)$ and $(M,\emptyset)$.
