The main tool used to construct 4--manifolds in later chapters is handle attachment.
We focus mainly on the definitions and results needed to meaningfully attach 1-- and 2--handles to a 4--manifold.

\begin{rmk}
	\label{rmk:corners}
	There is more than one way to define handle attachment, and we choose to do so in a way that feels more combinatorial in nature.
	The main concern with this approach is that the object resulting from handle attachment is a ``manifold with corners'' rather than a smooth manifold.
	There are arguments that the corners can be smoothed away in a canonical way such that a manifold obtained via handle attachment is smooth and unique up to diffeomorphism, but delving into such an argument at this point would be a distraction.
	\{NOTE: perhaps include an argument as an appendix?\}
	A construction that does not require the smoothing of corners can be found in \cite{Kosi93}, but the machinery makes explicit handle attachment unnecessarily complicated.
\end{rmk}

There is a common tool in topology called the \emph{attaching map} that we will use in this section and the next in order to build our machinery, so we take this opportunity to lay out the definition and notation.

\begin{defn}
  Let $X$ and $Y$ be topological spaces, $A\subset X$ a subspace, and $f:A\to Y$ a continuous map.
  We define a relation $\sim$ by putting $f(x)\sim x$ for every $x$ in $A$.
  Denote the quotient space $X\sqcup Y/\sim$ by $X\cup_f Y$.
  We call the map $f$ the \emph{attaching map}.  
  We say that $X$ is \emph{attached} or \emph{glued} to $Y$ over $A$.
  A space obtained through attachment is often called a \emph{adjunction space} or \emph{attachment space}.
\end{defn}

Throughout this section, we will have $n=\lambda+\mu$, $M$ an $n$--manifold with boundary, and $H^\lambda=\D^\lambda\times\D^\mu$.
Attaching an $n$--dimensional $\lambda$--handle to $M$ is the process of joining $M$ to $H^\lambda$ along an embedding of $\pd\D^\lambda\times\D^\mu$ in $\pd M$. 

\begin{defn}[Handle]
	\label{def:handle}
	Let $\varphi:\pd\D^\lambda\times\D^\mu\to\pd M$ be an embedding, and consider it to be an attaching map between $M$ and $H^\lambda$.
	The space $M\cup_\varphi H^\lambda$ is a ``manifold with corners,'' and we smooth those corners immediately smooth in a canonical way as mentioned in Remark \ref{rmk:corners}.
	We will continue to denote the smooth manifold obtained by $M\cup_\varphi H^\lambda$.
	The attached space $H^\lambda$ is an \emph{$n$--dimensional $\lambda$--handle}, and $M\cup_\varphi H^\lambda$ is the result of an $n$--dimensional \emph{$\lambda$--handle attachment}.
\end{defn}

Note that the domain of $\varphi$ has the structure of a trivial $\mu$--disc bundle over $S^{\lambda-1}$ and, using the language of vector bundles, the image of $\varphi$ has the structure of a closed tubular neighbourhood of $f_0(S^{\lambda-1})=\varphi\comp z(S^{\lambda-1})$.
Our uniqueness theorems for tubular neighbourhoods tell us that the closed tubular neighbourhood
\[
	f:\D_{\pd M}f_0(S^{\lambda-1})\to\overline{\nu}_{\pd M}\,f_0(S^{\lambda-1})
\]
of $f_0(S^{\lambda-1})$ is unique up to ambient isotopy of the embedding $f_0$.
Thus, if we have an embedding $f_0:S^{\lambda-1}\to \pd M$ (i.e.\ a knot) with trivial disc bundle, then a handle attachment can be defined using $f_0$ and an explicit embedding 
\[
	f: S^{\lambda-1}\times\D^\mu\to \D_{\pd M}\,f_0(S^{\lambda-1})
\]
for a closed tubular neighbourhood $\overline{\nu}_{\pd M}\,f_0(S^{\lambda-1})$.

In other words, the characteristics of handle attachment that fully describe the smooth $n$--manifold $M\cup_\varphi H^\lambda$ up to diffeomorphism are:
\begin{enumerate}
	\item The isotopy class of an embedding $f_0:S^{\lambda-1}\to\pd M$ with trivial normal disc bundle, and 
	\item the isotopy class of an identification of $S^{\lambda-1}\times\D^\mu$ with $\overline{\nu}_{\pd M}\,f_0(S^{\lambda-1})$.
\end{enumerate}

There is some specific language that is useful to the description of handle attachment.

\begin{defn}
	Let $M\cup_\varphi H^\lambda$ be an $n$--manifold with a $\lambda$--handle attached.
	The embedding $f_0:S^{\lambda-1}\to\pd M$ is called the \emph{attaching map}, its image $f_0(S^{\lambda-1})$ is the \emph{attaching sphere}, and its tubular neighbourhood is the \emph{attaching neighbourhood}.
	The embedding $f: S^{\lambda-1}\times \D^\mu\to \overline{\nu}_{\pd M}\,f_0(S^{\lambda-1})$ is called a \emph{normal framing} or just \emph{framing}.
	Inside of the $\lambda$--handle $H^\lambda=\D^\lambda\times\D^\mu$, the disc $\D^\lambda\times\{\vec{0}\}$ is the \emph{core}, and the disc $\{\vec{0}\}\times\D^\mu$ is the \emph{cocore}.
	The boundary circle $\{\vec{0}\}\times S^{\mu-1}$ of the cocore is the \emph{belt sphere}.
	The integer $\lambda$ is the \emph{index} of the handle.
\end{defn}

There are two special cases of handle attachment to discuss.
First, let $M$ be orientable and path--connected with $\pd M$ compact, connected, and nonempty.
The attaching sphere of a 1--handle is $S^0=\pd \D^1$, which is a pair of points.
There is a unique isotopy class of embeddings $f_0:S^0\to\pd M$.
This means that $M\cup_\varphi H^1$ is determined entirely by the framing $f$.
The normal disc bundle of $f_0(S^0)$ is a bundle over $S^0$, so it is vacuously trivial.
Using the vector bundle structure of the tubular neighbourhood, we write an embedding of $S^0\times\D^{n-1}\to S^0\times\D^{n-1}$ as a pair of length--preserving linear transformations $\R^{n-1}\to\R^{n-1}$, i.e.\ elements of $\orth{n-1}{\R}$, each restricted to act on one of the connected components of $S^0\times\D^{n-1}$.
The determinant of an element of $\orth{n-1}{\R}$ is either $1$ or -$1$, and $\orth{n-1}{\R}$ has two path--connected components corresponding to these two cases.
Every element of $\orth{n-1}{\R}$ is an embedding $\R^{n-1}\to\R^{n-1}$, so any path in $\orth{n-1}{\R}$ is an isotopy of its endpoints.
It is then easy to see that are four isotopy classes of our trivialization, and those fall into two types.
Either both transformations are are orientation preserving (reversing), or one is orientation preserving (reversing) and the other is orientation reversing (preserving).
Under the first type of automorphism, $M\cup_\varphi H^1$ is a non-orientable manifold.
Under the second, $M\cup_\varphi H^1$ is orientable.

Next, let $W$ be a 4--manifold with orientable boundary $M$.
To attach a 2--handle to $W$, we need an embedding $f_0:S^1\to M$ and a framing $S^1\times\D^2\to\overline{\nu}_{\pd M}f_0(S^1)$.
The space $S^1\times D^2$ is what we call a solid torus.

\begin{defn}
	A space $V$ that is homeomorphic to $S^1\times\DD$ is called a \emph{solid torus}.	
	A simple closed curve $J$ in $\pd V$ that bounds a 2--disc in $V$ is called a \emph{meridian}.
	A simple closed curve $K$ in $\pd V$ that intersects a meridian at a single point is called a \emph{longitude}.
	Note that there are infinitely many isotopy classes of longitudes of $V$, whereas there's exactly one isotopy class of meridians.
\end{defn}

Once an embedding $f_0:S^1\to M$ is chosen, $W\cup_\varphi H^2$ is determined by the framing $f:S^1\times \D^2\to \overline{\nu}_{\pd M}\,f(S^1)$.
To investigate possible framings, we consider the \emph{mapping class group} of the solid torus.
The mapping class group of a space $X$ is the group of isotopy classes of automorphisms $X$, and it is denoted $mpg(X)$.
For $V$ a solid torus, $mpg(V)$ is very closely linked to the mapping class group of the torus $T^2 = S^1\times S^1=\pd V$, which is the special linear group $\textrm{SL}_2(\Z)$, the group of $2\times 2$ matrices with integer entries and determinant $\pm 1$.
\begin{lem}
	Let $V$ be a solid torus and let $f$ be an automorphism of the torus $\pd V$.
	Then $h$ extends to an automorphism of $V$ if and only if $f$ maps a meridian to a meridian.	
\end{lem}

\begin{lem}
	A pair of automorphisms $f,g$ of $V$ that agree on $\pd V$ and map a meridian to a meridian are isotopic.	
\end{lem}

\begin{theorem}
	The mapping class group of a solid torus $V$ is the subgroup of the mapping class group of $\pd V$ containing automorphisms that map meridians to meridians.
	This subgroup is isomorphic to $\Z$.	
\end{theorem}

\begin{proof}
	In \cite{Rolf76}, it is shown that the mapping class group of $T^2$ is $\textrm{SL}_2(\Z)$ by generating the group from a pair of basic automorphisms of $T^2$ called \emph{twists}, and the swapping map $(z,w)\to(w,z)$.
	The twists are defined as:
	\[
	\begin{array}{ccccc}
	h_L(e^{i\theta},e^{i\phi}) & = & (e^{i(\theta+\phi)},e^{i\phi}) & & \textrm{``longitudinal twist''} \\
	
	h_M(e^{i\theta},e^{i\phi}) & = & (e^{i\theta},e^{i(\theta+\phi)}) & & \textrm{``meridinal twist''}	
	\end{array}
	\]
	Fix the meridinal and longitudinal directions of the boundary of a solid torus $V$ to coincide with the meridinal and longitudinal directions of $V$.
	This would mean that if we are writing $V=S^1\times D^2$, $\{1\}\times S^1$ is a meridian and $S^1\times\{1\}$ is a longitude.
	Notice that the meridinal twist maps a meridian to a meridian, so it extends to an automorphism of $V$.
	Also, neither the longitudinal twist nor the swap map a meridian to a meridian, so neither extend to an automorphism of $V$.
	
	Let $F$ be an automorphism of $V$ with restriction $f$ to $\pd V$.
	Because $f$ is an automorphism of $\pd V$, it can be written as the product of twists and swaps.
	Because $f$ preserves meridians, it can be written entirely as a power of the meridinal twist.
	In the other direction, any automorphism that is the power of a meridinal twist clearly preserves meridians.
	Because these automorphisms are written as powers of $h_M$, there is a clear isomorphism from this subgroup to $\Z$.
\end{proof}

\begin{rmk}
  The content of these results means that the attachment of a 2--handle to a 4--manifold can be described by an embedding $f_0:S^1\to M$ and an integer $k$ called the \emph{framing constant} that determines the framing automorphism as long as we know what a framing constant of $0$ means.
  To see this, first notice that $h_M$ can be extended to
  \[
	  \begin{array}{cccc}
		  H_M: & S^1\times\DD & \to & S^1\times\DD \\
			  & (e^{i\theta}, re^{i\phi}) & \mapsto & (e^{i\theta},re^{i(\phi+\theta)})	
	  \end{array}
  \]
  which represents a generator of $mpg(S^1\times\DD)$.
  Because $\nu_{\pd M}\,f(S^1)$ is a solid torus, a one-to-one correspondence
  $\psi$ between $mpg(S^1\times\R^2)$ and the isotopy classes of maps $S^1\times\DD\to\nu_{\pd M}\,f(S^1)$ is determined entirely by $\psi(\id)$.
  The image of $\psi(\id)$ is called the class of \emph{preferred framings}.
  Sometimes, there is a canonical class of preferred framings.
  One important case is when $M$ is $S^3$.

  Let $f_0:S^1\to S^3$ be an embedding.
  Let $V$ be a solid torus that is a closed tubular neighbourhood of the knot $f_0(S^1)$ in $S^3$.
  Then there is exactly one isotopy class $[J]$ of longitudes of $V$, unique up to ambient isotopy of $f_0$, such that any curve in $[J]$ bounds a disc in $S^3\setminus V$.
  Moreover, for any representative $J$ of $[J]$ there is a framing $f_J:S^1\times\DD\to V$ such that $f_J(S^1\times\{\vec{1}\})=J$, and the isotopy class of $[f_J]$ is in one--to--one correspondence with $[J]$.
  Our canonical choice for $\psi(\id)$ is $[f_J]$, and this generates the rest of the map, i.e.\ $\psi([H_M^k])=[f_J\comp H_M^k]$.
  The isotopy class of a framing $f:S^1\times\DD\to\overline{\nu}_{S^3}f_0(S^1)$ can then be classified entirely by an integer $k$ that describes the number of meridinal twists it takes to get to $f$ from the preferred one.
  We call $k$ the \emph{framing constant} for $f$.
\end{rmk}

It is convenient to now delve into some Morse theory.
The fundamental theorems of Morse theory are used to define the \emph{handle decomposition} and \emph{dual handle decomposition} of a manifold.

\begin{defn}
  A generic smooth function $f:M\to\R$ where $M$ is an $n$--manifold is called a \emph{Morse function}.
  For a critical point $p\in M$ of $f$, the \emph{index} of $p$ is the dimension of the largest subspace of $T_p M$ such that $d^2f_p$ is negative definite.
  Less formally, this corresponds to the number of independent directions in $M$ along which $f$ decreases.
  We denote by $M^a$ the subspace $f\inv(-\infty,a\,]$ where $f$ is a fixed Morse function on $M$.
\end{defn}

A key question of Morse theory regards how the topology of $M^a$ changes as $a$ passes the critical values of $f$.
This question is answered by the following two theorems.

\begin{theorem}
  \label{thm:morseretract}
  Let $f:M\to\R$ be a Morse function with no critical values in $(a,b\,]$, $a<b$.
  If $f\inv[\,a,b\,]$ is compact, then $M^a$ and $M^b$ are diffeomorphic, and $M^b$ deformation retracts onto $M^a$.
\end{theorem}

\begin{theorem}
  \label{thm:morsehandle}
  Let $f:M\to\R$ be a Morse function.
  Let $p$ be a critical point of $f$ of index $\lambda$ with associated critical value $f(p)=q$.
  If $f\inv[\,q-\varepsilon, q+\varepsilon\,]$ is compact and contains no critical points other than $p$, then $M^{q+\varepsilon}$ is diffeomorphic to $M^{q-\varepsilon}\cup_\varphi H^\lambda$ for some attaching map $\varphi:S^{\lambda-1}\times\D^\mu\to \pd(M^{q-\varepsilon})$.
\end{theorem}

\begin{defn}
  Let $f:M\to\R$ be a Morse function on a closed $n$--manifold $M$ with critical points $\{p_1,\dots,p_k\}$ of indices $\{\lambda_1,\dots,\lambda_k\}$ and a set $\{t_0,\dots,t_k\}$ of numbers in $\R$ such that
  \[
	0\leq t_0 < f(p_1) < t_1 < f(p_2) < \cdots < t_{k-1} < f(p_k) < t_k \leq 1,
  \]
  and
  \[
	  \lambda_1 \geq \lambda_2 \geq \cdots \geq \lambda_k.
  \]
  The previous theorems guarantee that, for each $i\geq 1$, $f\inv[\,t_{i-1},t_i\,]$ is diffeomorphic to $(f\inv(t_{i-1})\times\I)\cup H^{\lambda_i}$, giving us a realization of $M$ as
  \[
	  \emptyset = M_0 \subset M_1 \subset M_2 \subset \cdots \subset M_{k-1} \subset M_k = M
  \]
  where $M_i$ is obtained from $M_{i-1}$ by attaching a $\lambda_i$--handle.
  Such a realization is called a \emph{handle decomposition} of $M$.
\end{defn}

A Morse function $f$ satisfying the requirements to define a handle decomposition actually defines two handle decompositions -- one from $f$ and one from $1-f$.
The handle decompositions from $f$ and $1-f$ are dual in the sense that every $\lambda$--handle attached in the making of the decomposition from $f$ has a corresponding $\mu$--handle in the decomposition from $1-f$.
This handle is realized by reversing the roles of the core and co--core in a given $\lambda$--handle $H^\lambda$ to obtain a $\mu$--handle $H^\mu$.

Similar results can be found for manifolds with boundary.
Let $W$ be an $n$--manifold with boundary $\pd W = M_0\sqcup M_1$, where both $M_0$ and $M_1$ are compact.
The Morse functions on $W$ that extend Theorems \ref{thm:morseretract} and \ref{thm:morsehandle} are those that fix $f(M_0)=0$, $f(M_1)=1$.
Now, the handle decomposition of $W$ is built on top of the component $M_1\times\{1\}$ of $M_0\times\I$, with $M_0\times\{0\}$ corresponding to the boundary component $M_0$ in the finished product.
